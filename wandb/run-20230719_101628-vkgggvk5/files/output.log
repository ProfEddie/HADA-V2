Trainable Paras: 4725772
TRAIN FROM SCRATCH
0.0
  0%|                                                           | 0/20 [00:00<?, ?it/s]
  0%|                                                         | 0/3625 [00:00<?, ?it/s]

  offset = -low * scale                             | 1/3625 [00:05<5:37:21,  5.59s/it]
0.00027586206896551725
current loss: 28.22034454345703
  0%|                                               | 2/3625 [00:09<4:23:47,  4.37s/it]

  0%|                                               | 3/3625 [00:12<4:00:22,  3.98s/it]
current loss: 27.643665313720703

  offset = -low * scale                             | 4/3625 [00:16<3:49:31,  3.80s/it]
current loss: 27.226774215698242
0.001103448275862069
current loss: 27.004186630249023
  0%|                                               | 5/3625 [00:19<3:43:08,  3.70s/it]
0.001379310344827586

  0%|                                               | 6/3625 [00:23<3:39:46,  3.64s/it]
0.0016551724137931034

  0%|                                               | 7/3625 [00:26<3:38:33,  3.62s/it]

  0%|                                               | 8/3625 [00:30<3:37:21,  3.61s/it]
current loss: 26.343217849731445

  0%|                                               | 9/3625 [00:33<3:35:42,  3.58s/it]
current loss: 26.381973266601562
0.0024827586206896553

  0%|▏                                             | 10/3625 [00:37<3:34:25,  3.56s/it]
0.002758620689655172

  0%|▏                                             | 11/3625 [00:40<3:33:52,  3.55s/it]

  0%|▏                                             | 12/3625 [00:44<3:33:36,  3.55s/it]
current loss: 25.813451766967773

  0%|▏                                             | 13/3625 [00:48<3:33:56,  3.55s/it]
current loss: 25.71027183532715
0.003586206896551724

  0%|▏                                             | 14/3625 [00:51<3:33:05,  3.54s/it]
0.0038620689655172414

  0%|▏                                             | 15/3625 [00:55<3:32:47,  3.54s/it]

  0%|▏                                             | 16/3625 [00:58<3:33:09,  3.54s/it]
current loss: 24.962377548217773

  0%|▏                                             | 17/3625 [01:02<3:33:03,  3.54s/it]
current loss: 24.740055084228516

  0%|▏                                             | 18/3625 [01:05<3:33:43,  3.56s/it]
current loss: 24.869430541992188
0.004965517241379311

  1%|▏                                             | 19/3625 [01:09<3:34:10,  3.56s/it]
0.005241379310344828

  1%|▎                                             | 20/3625 [01:12<3:34:33,  3.57s/it]

  1%|▎                                             | 21/3625 [01:16<3:35:19,  3.58s/it]
current loss: 24.04950523376465

  1%|▎                                             | 22/3625 [01:20<3:34:12,  3.57s/it]
current loss: 23.998504638671875
0.006068965517241379

  1%|▎                                             | 23/3625 [01:23<3:33:43,  3.56s/it]
0.006344827586206896


  1%|▎                                             | 25/3625 [01:30<3:33:01,  3.55s/it]
0.006620689655172414
current loss: 23.647737503051758

  1%|▎                                             | 26/3625 [01:34<3:33:03,  3.55s/it]
current loss: 23.5920467376709

  1%|▎                                             | 27/3625 [01:37<3:34:25,  3.58s/it]
current loss: 23.40103530883789
0.0074482758620689656

  1%|▎                                             | 28/3625 [01:41<3:35:52,  3.60s/it]
0.007724137931034483

  1%|▎                                             | 29/3625 [01:45<3:34:47,  3.58s/it]

  1%|▍                                             | 30/3625 [01:48<3:34:36,  3.58s/it]
current loss: 22.831205368041992

  1%|▍                                             | 31/3625 [01:52<3:34:24,  3.58s/it]
current loss: 22.933454513549805
0.008551724137931035

  1%|▍                                             | 32/3625 [01:55<3:32:57,  3.56s/it]
0.008827586206896552


  1%|▍                                             | 34/3625 [02:02<3:33:17,  3.56s/it]
0.00910344827586207
current loss: 22.794761657714844

  1%|▍                                             | 35/3625 [02:06<3:33:16,  3.56s/it]
current loss: 22.794631958007812

  1%|▍                                             | 36/3625 [02:10<3:33:40,  3.57s/it]
current loss: 22.437824249267578
0.009931034482758621

  1%|▍                                             | 37/3625 [02:13<3:35:08,  3.60s/it]
0.010206896551724139


  1%|▍                                             | 39/3625 [02:20<3:34:22,  3.59s/it]
0.010482758620689656
current loss: 22.244564056396484

  1%|▌                                             | 40/3625 [02:24<3:33:32,  3.57s/it]
current loss: 22.290203094482422

  1%|▌                                             | 41/3625 [02:27<3:33:13,  3.57s/it]
current loss: 22.345455169677734
0.011310344827586206

  1%|▌                                             | 42/3625 [02:31<3:32:37,  3.56s/it]
0.011586206896551723

  1%|▌                                             | 43/3625 [02:35<3:32:42,  3.56s/it]

  1%|▌                                             | 44/3625 [02:38<3:32:26,  3.56s/it]
current loss: 21.969736099243164

  1%|▌                                             | 45/3625 [02:42<3:32:30,  3.56s/it]
current loss: 21.645004272460938
0.012413793103448275

  1%|▌                                             | 46/3625 [02:45<3:31:59,  3.55s/it]
0.012689655172413793


  1%|▌                                             | 48/3625 [02:52<3:32:31,  3.56s/it]
0.01296551724137931
current loss: 22.030376434326172

  1%|▌                                             | 49/3625 [02:56<3:33:19,  3.58s/it]
current loss: 21.554601669311523

  1%|▋                                             | 50/3625 [02:59<3:32:36,  3.57s/it]
current loss: 21.742883682250977

  1%|▋                                             | 51/3625 [03:03<3:36:00,  3.63s/it]
current loss: 21.54732322692871
0.01406896551724138

  1%|▋                                             | 52/3625 [03:07<3:35:16,  3.62s/it]
0.014344827586206896
Traceback (most recent call last):                 | 53/3625 [03:10<3:35:35,  3.62s/it]
  File "/home/nmduy/HADA/chau/HADA-LAVIS/main_lorentz.py", line 127, in <module>
    run_train(args)
  File "/home/nmduy/HADA/chau/HADA-LAVIS/main_lorentz.py", line 73, in run_train
    controller.train(dataset_train=train_dataset,  dataset_val=val_dataset,
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Controller_Lorentz.py", line 448, in train
    loss_tr_dict = self.train_epoch(dataloader_train, idx_epoch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Controller_Lorentz.py", line 348, in train_epoch
    for idx, batch in enumerate(dataloader):
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Utils.py", line 251, in __getitem__
    image_output_1 = extract_features(self.model_1, sample_1, mode='image', is_clip='clip' in self.model_1_name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Utils.py", line 111, in extract_features
    model.eval()
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2307, in eval
    return self.train(False)
           ^^^^^^^^^^^^^^^^^
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2288, in train
    module.train(mode)
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2288, in train
    module.train(mode)
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2288, in train
    module.train(mode)
  [Previous line repeated 1 more time]
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/nn/modules/module.py", line 2269, in train
    def train(self: T, mode: bool = True) -> T:
KeyboardInterrupt