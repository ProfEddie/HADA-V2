Trainable Paras: 4725772
TRAIN FROM SCRATCH
0.0
  0%|                                                                                                                                                                        | 0/20 [00:00<?, ?it/s]
  0%|                                                                                                                                                                      | 0/3625 [00:00<?, ?it/s]

  0%|                                                                                                                                                            | 1/3625 [00:05<5:38:28,  5.60s/it]
0.00027586206896551725

  0%|                                                                                                                                                            | 2/3625 [00:09<4:24:57,  4.39s/it]
0.0005517241379310345

  0%|▏                                                                                                                                                           | 3/3625 [00:12<4:01:06,  3.99s/it]
0.0008275862068965517

  0%|▏                                                                                                                                                           | 4/3625 [00:16<3:50:24,  3.82s/it]

  0%|▏                                                                                                                                                           | 5/3625 [00:19<3:43:59,  3.71s/it]

  offset = -low * scale                                                                                                                                          | 5/3625 [00:19<3:43:59,  3.71s/it]
0.001379310344827586
current loss: 22.415298461914062
  0%|▎                                                                                                                                                           | 6/3625 [00:23<3:39:29,  3.64s/it]
0.0016551724137931034

  0%|▎                                                                                                                                                           | 7/3625 [00:26<3:36:43,  3.59s/it]

  offset = -low * scale                                                                                                                                          | 7/3625 [00:26<3:36:43,  3.59s/it]
current loss: 21.32991600036621
  0%|▎                                                                                                                                                           | 8/3625 [00:30<3:35:31,  3.58s/it]

  0%|▍                                                                                                                                                           | 9/3625 [00:33<3:34:52,  3.57s/it]
current loss: 20.946199417114258
0.0024827586206896553

  0%|▍                                                                                                                                                          | 10/3625 [00:37<3:34:13,  3.56s/it]
0.002758620689655172

  0%|▍                                                                                                                                                          | 11/3625 [00:40<3:33:11,  3.54s/it]
0.0030344827586206895

  0%|▌                                                                                                                                                          | 12/3625 [00:44<3:32:37,  3.53s/it]
0.003310344827586207

  0%|▌                                                                                                                                                          | 13/3625 [00:47<3:32:26,  3.53s/it]
0.003586206896551724

  0%|▌                                                                                                                                                          | 14/3625 [00:51<3:32:40,  3.53s/it]
0.0038620689655172414

  0%|▋                                                                                                                                                          | 15/3625 [00:54<3:32:49,  3.54s/it]
0.004137931034482759

  0%|▋                                                                                                                                                          | 16/3625 [00:58<3:32:02,  3.53s/it]
0.004413793103448276

  0%|▋                                                                                                                                                          | 17/3625 [01:02<3:32:12,  3.53s/it]
0.004689655172413793

  0%|▊                                                                                                                                                          | 18/3625 [01:05<3:31:20,  3.52s/it]
0.004965517241379311

  1%|▊                                                                                                                                                          | 19/3625 [01:09<3:32:33,  3.54s/it]
0.005241379310344828

  1%|▊                                                                                                                                                          | 20/3625 [01:12<3:32:41,  3.54s/it]

  1%|▉                                                                                                                                                          | 21/3625 [01:16<3:32:35,  3.54s/it]
current loss: 18.568891525268555

  1%|▉                                                                                                                                                          | 22/3625 [01:19<3:33:32,  3.56s/it]
current loss: 18.639217376708984
0.006068965517241379

  1%|▉                                                                                                                                                          | 23/3625 [01:23<3:33:27,  3.56s/it]
0.006344827586206896

  1%|█                                                                                                                                                          | 24/3625 [01:26<3:33:34,  3.56s/it]
0.006620689655172414

  1%|█                                                                                                                                                          | 25/3625 [01:30<3:32:44,  3.55s/it]

  1%|█                                                                                                                                                          | 26/3625 [01:33<3:33:00,  3.55s/it]
current loss: 18.358125686645508

  1%|█▏                                                                                                                                                         | 27/3625 [01:37<3:33:15,  3.56s/it]
current loss: 17.767610549926758
0.0074482758620689656

  1%|█▏                                                                                                                                                         | 28/3625 [01:41<3:33:30,  3.56s/it]
0.007724137931034483

  1%|█▏                                                                                                                                                         | 29/3625 [01:44<3:37:10,  3.62s/it]
0.008

  1%|█▎                                                                                                                                                         | 30/3625 [01:48<3:35:41,  3.60s/it]

  1%|█▎                                                                                                                                                         | 31/3625 [01:51<3:35:04,  3.59s/it]
current loss: 17.41539764404297

  1%|█▎                                                                                                                                                         | 32/3625 [01:55<3:34:35,  3.58s/it]
current loss: 17.43564224243164
0.008827586206896552

  1%|█▍                                                                                                                                                         | 33/3625 [01:59<3:34:10,  3.58s/it]
0.00910344827586207

  1%|█▍                                                                                                                                                         | 34/3625 [02:02<3:33:38,  3.57s/it]

  1%|█▍                                                                                                                                                         | 35/3625 [02:06<3:33:29,  3.57s/it]
current loss: 17.203264236450195

  1%|█▌                                                                                                                                                         | 36/3625 [02:09<3:32:37,  3.55s/it]
current loss: 16.834054946899414
0.009931034482758621

  1%|█▌                                                                                                                                                         | 37/3625 [02:13<3:33:32,  3.57s/it]
0.010206896551724139

  1%|█▌                                                                                                                                                         | 38/3625 [02:16<3:33:25,  3.57s/it]
0.010482758620689656

  1%|█▋                                                                                                                                                         | 39/3625 [02:20<3:33:18,  3.57s/it]
0.010758620689655173

  1%|█▋                                                                                                                                                         | 40/3625 [02:24<3:32:33,  3.56s/it]

  1%|█▊                                                                                                                                                         | 41/3625 [02:27<3:32:44,  3.56s/it]
current loss: 16.061965942382812
0.011310344827586206

  1%|█▊                                                                                                                                                         | 42/3625 [02:31<3:32:20,  3.56s/it]
0.011586206896551723

  1%|█▊                                                                                                                                                         | 43/3625 [02:34<3:32:58,  3.57s/it]
0.01186206896551724

  1%|█▉                                                                                                                                                         | 44/3625 [02:38<3:32:48,  3.57s/it]

  1%|█▉                                                                                                                                                         | 45/3625 [02:41<3:31:50,  3.55s/it]
current loss: 15.677169799804688
0.012413793103448275

  1%|█▉                                                                                                                                                         | 46/3625 [02:45<3:32:15,  3.56s/it]
0.012689655172413793

  1%|██                                                                                                                                                         | 47/3625 [02:48<3:31:32,  3.55s/it]
0.01296551724137931

  1%|██                                                                                                                                                         | 48/3625 [02:52<3:31:32,  3.55s/it]
0.013241379310344827

  1%|██                                                                                                                                                         | 49/3625 [02:56<3:31:50,  3.55s/it]

  1%|██▏                                                                                                                                                        | 50/3625 [02:59<3:32:57,  3.57s/it]
current loss: 15.16581916809082
0.013793103448275862

  1%|██▏                                                                                                                                                        | 51/3625 [03:03<3:32:12,  3.56s/it]
0.01406896551724138

  1%|██▏                                                                                                                                                        | 52/3625 [03:06<3:32:14,  3.56s/it]
0.014344827586206896

  1%|██▎                                                                                                                                                        | 53/3625 [03:10<3:31:44,  3.56s/it]

  1%|██▎                                                                                                                                                        | 54/3625 [03:13<3:31:32,  3.55s/it]
current loss: 14.605891227722168
0.014896551724137931

  2%|██▎                                                                                                                                                        | 55/3625 [03:17<3:32:37,  3.57s/it]
0.015172413793103448

  2%|██▍                                                                                                                                                        | 56/3625 [03:21<3:32:04,  3.57s/it]
0.015448275862068966

  2%|██▍                                                                                                                                                        | 57/3625 [03:24<3:35:23,  3.62s/it]
0.01572413793103448

  2%|██▍                                                                                                                                                        | 58/3625 [03:28<3:40:05,  3.70s/it]
0.016

  2%|██▌                                                                                                                                                        | 59/3625 [03:32<3:40:56,  3.72s/it]
0.016275862068965516

  2%|██▌                                                                                                                                                        | 60/3625 [03:36<3:41:01,  3.72s/it]

  2%|██▌                                                                                                                                                        | 61/3625 [03:39<3:41:32,  3.73s/it]
Traceback (most recent call last):                                                                                                                              | 61/3625 [03:39<3:41:32,  3.73s/it]
  File "/home/nmduy/HADA/chau/HADA-LAVIS/main_lorentz.py", line 127, in <module>
    run_train(args)
  File "/home/nmduy/HADA/chau/HADA-LAVIS/main_lorentz.py", line 73, in run_train
    controller.train(dataset_train=train_dataset,  dataset_val=val_dataset,
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Controller_Lorentz.py", line 448, in train
    loss_tr_dict = self.train_epoch(dataloader_train, idx_epoch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Controller_Lorentz.py", line 348, in train_epoch
    for idx, batch in enumerate(dataloader):
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Utils.py", line 215, in __getitem__
    data = self.dataset[index] # dict with image, text_input, image_id, instance_id keys
           ~~~~~~~~~~~~^^^^^^^
  File "/home/nmduy/HADA/chau/HADA-LAVIS/LAVIS/lavis/datasets/datasets/retrieval_datasets.py", line 50, in __getitem__
    image = Image.open(image_path).convert("RGB")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/PIL/Image.py", line 933, in convert
    self.load()
  File "/home/jarvis/anaconda3/envs/hada-v2/lib/python3.11/site-packages/PIL/ImageFile.py", line 269, in load
    n, err_code = decoder.decode(b)
                  ^^^^^^^^^^^^^^^^^
KeyboardInterrupt