Trainable Paras: 9988097
TRAIN FROM SCRATCH
  0%|                                                                                                                                                                                 | 0/100 [00:00<?, ?it/s]

  offset = -low * scale                                                                                                                                                              | 0/3625 [00:00<?, ?it/s]
/home/nmduy/HADA/chau/HADA-LAVIS/LAVIS/lavis/processors/randaugment.py:40: RuntimeWarning: overflow encountered in scalar negative
  offset = -low * scale
0.0
  0%|                                                                                                                                                                                 | 0/100 [00:49<?, ?it/s]
Traceback (most recent call last):
  File "main.py", line 126, in <module>
    run_train(args)
  File "main.py", line 72, in run_train
    controller.train(dataset_train=train_dataset,  dataset_val=val_dataset,
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Controller_Hyp.py", line 463, in train
    loss_tr_dict = self.train_epoch(dataloader_train, idx_epoch, writer)
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Controller_Hyp.py", line 341, in train_epoch
    br = self.forward_batch(batch)
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Controller_Hyp.py", line 294, in forward_batch
    sim_i2t = dist_f(img_enc, cap_enc_all) / self.temp_para
  File "/home/nmduy/HADA/chau/HADA-LAVIS/Controller_Hyp.py", line 284, in <lambda>
    dist_f = lambda x, y: -dist_matrix(x, y, c=0.1)
  File "/home/nmduy/HADA/chau/HADA-LAVIS/hyptorch/math.py", line 489, in dist_matrix
    return _dist_matrix(x, y, c)
  File "/home/nmduy/HADA/chau/HADA-LAVIS/hyptorch/math.py", line 483, in _dist_matrix
    * artanh(sqrt_c * torch.norm(_mobius_addition_batch(-x, y, c=c), dim=-1))
  File "/home/nmduy/HADA/chau/HADA-LAVIS/hyptorch/math.py", line 413, in _mobius_addition_batch
    xy = _tensor_dot(x, y)  # B x C
  File "/home/nmduy/HADA/chau/HADA-LAVIS/hyptorch/math.py", line 408, in _tensor_dot
    res = torch.einsum("ij,kj->ik", (x, y))
  File "/home/jarvis/anaconda3/envs/chau/lib/python3.8/site-packages/torch/functional.py", line 373, in einsum
    return einsum(equation, *_operands)
  File "/home/jarvis/anaconda3/envs/chau/lib/python3.8/site-packages/torch/functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
RuntimeError: einsum(): subscript j has size 64040 for operand 1 which does not broadcast with previously seen size 512